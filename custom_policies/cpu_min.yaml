metadata:
  name: Enforce maximum CPU and Memory
  id: CUSTOM_VSPHERE_002
  category: Performance
  severity: HIGH
  version: 1.0.0

scope:
  provider: vsphere
  resource_types:
    - vsphere_virtual_machine

definition:
  and:
    - cond_type: attribute
      attribute: num_cpus
      operator: within
      value:
        - 1
        - 2
        - 3
        - 4
    - cond_type: attribute
      attribute: memory
      operator: within
      value:
        - 512
        - 1024
        - 1536
        - 2048
