metadata:
  name: Ensure VM connected to public network has firewall rule
  id: CUSTOM_VSPHERE_006
  category: Network Security
  severity: HIGH
  version: 1.0.0

scope:
  provider: vsphere
  resource_types:
    - vsphere_virtual_machine

definition:
  and:
    # Vérifie que le réseau est public
    - cond_type: attribute
      attribute: network_interface.network_type
      operator: equals
      value: "public"

    # Vérifie qu'il existe une règle de firewall associée
    - cond_type: attribute
      attribute: firewall_rule
      operator: exists
